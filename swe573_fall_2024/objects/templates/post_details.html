{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'objects/css/post_details.css' %}">
    <title>{{ post.title }}</title>
</head>
<body class="post-details-page">
    <!-- Header -->
    <header>
        <a href="{% url 'homepage' %}">Home</a>
        <h1>Post Details</h1>
    </header>

    <!-- Ana İçerik -->
    <div class="container">
        <div id="post-details">
            <!-- Post İçeriği -->
            <div class="post-content">
                <h2>{{ post.title }}</h2>
                <p>{{ post.content }}</p>
                {% if post.image %}
                <img src="{{ post.image.url }}" alt="{{ post.title }}">
                {% endif %}

                <!-- Butonlar ve Metadata -->
                <div class="button-group">
                    <form method="GET" action="{% url 'search_results' %}" style="display: inline;">
                        <button class="button" type="submit">Search Wikidata</button>
                    </form>
                    {% if can_mark_as_solved %}
                    <form method="POST" action="{% url 'mark_as_solved' post.id %}" style="display: inline;">
                        {% csrf_token %}
                        <button class="button" type="submit">Mark as Solved</button>
                    </form>
                    {% endif %}
                    <small>Author: {{ post.author.username }} | {{ post.created_at }} | Answers: {{ post.comments.count }}</small>
                </div>

                <!-- Yorumlar -->
                <div id="comments-section">
                    <h3>Comments</h3>
                    {% for comment in comments %}
                    <div class="comment">
                        <p>{{ comment.content }}</p>
                        <small>Author: {{ comment.user.username|default:"Anonymous" }} | {{ comment.created_at }}</small>
                    </div>
                    {% empty %}
                    <p>No comments yet. Be the first to comment!</p>
                    {% endfor %}
                </div>

                <!-- Yorum Ekleme Formu -->
                <form id="comment-form" method="POST" action="{% url 'add_comment' post.id %}">
                    {% csrf_token %}
                    <textarea name="content" placeholder="Add your comment here..." required></textarea>
                    <button type="submit">Submit</button>
                </form>
            </div>

            <!-- Properties Bilgileri -->
            <div class="post-properties">
                <h2>Properties</h2>
                <ul>
                    <li><strong>Material:</strong> {{ post.material|default:"None" }}</li>
                    <li><strong>Size (cm):</strong> {{ post.size|default:"None" }}</li>
                    <li><strong>Color:</strong> {{ post.color|default:"None" }}</li>
                    <li><strong>Shape:</strong> {{ post.shape|default:"None" }}</li>
                    <li><strong>Weight (gr):</strong> {{ post.weight|default:"None" }}</li>
                </ul>
            </div>
        </div>
    </div>
</body>
</html>


{% comment %} {% load static %}

<link rel="stylesheet" href="{% static 'objects/css/post_details.css' %}">

<div id="post-details">
    <h2>{{ post.title }}</h2>
    <p>{{ post.content }}</p>
    <h2>Properties</h2>
    <ul>
        <li><strong>Material:</strong> {{ post.material }}</li>
        <li><strong>Size (cm):</strong> {{ post.size }}</li>
        <li><strong>Color:</strong> {{ post.color }}</li>
        <li><strong>Shape:</strong> {{ post.shape }}</li>
        <li><strong>Weight (gr):</strong> {{ post.weight }}</li>
    </ul>

    <form action="{% url 'search_results' %}" method="GET">
        <input type="hidden" name="q" value="
            {% if post.material %}{{ post.material }} {% endif %}
            {% if post.size %}{{ post.size }}cm {% endif %}
            {% if post.color %}{{ post.color }} {% endif %}
            {% if post.shape %}{{ post.shape }} {% endif %}
            {% if post.weight %}{{ post.weight }}kg{% endif %}
        ">
        <button type="submit">Search Wikidata</button>
    </form> {% endcomment %}

    {% comment %} <div style="margin-top: 20px;">
        <form action="{% url 'analyze_post' post.id %}" method="GET">
            <button type="submit">Analyze Post</button>
        </form>
    </div> {% endcomment %}
        <!-- NLP ile Çıkarılan Anahtar Kelimeler -->
        {% comment %} <h3>Extracted Keywords:</h3>
        <ul>
            {% for keyword in keywords %}
                <li>{{ keyword }}</li>
            {% endfor %}
        </ul> {% endcomment %}
    
        <!-- Anahtar Kelimelerle Wikidata Arama Butonu -->
        {% comment %} <form action="{% url 'search_results' %}" method="GET" class="wikidata-search-form">
            <input type="hidden" name="q" value="{% for keyword in keywords %}{{ keyword }} {% endfor %}">
            <button type="submit" class="btn btn-primary">Search Wikidata</button>
        </form> {% endcomment %}

    {% comment %} <div class="post-image-container" style="text-align: center;">
        {% if post.image %}
        <img src="{{ post.image.url }}" alt="{{ post.title }}" style="width: 100%; max-width: 800px; height: auto;">
        {% endif %}
    </div>
    <small>
        Author: {{ post.author.username }}
    </small>
    <small> | {{ post.created_at }} | </small>
    <small> {% if user.is_authenticated %} | 
        Answers: {{ post.comments.count }}
        {% endif %} </small>

        {% if can_mark_as_solved %}
        <form method="POST" action="{% url 'mark_as_solved' post.id %}">
            {% csrf_token %}
            <button type="submit">Mark as Solved</button>
        </form>
    {% elif post.solved %}
        <p><strong>This post has been marked as solved.</strong></p>
    {% endif %}

    <div id="comments-section">
        {% include 'partials/comments.html' with post=post comments=comments %}
    </div>

   

    {% if not post.solved %}
    <form id="comment-form" method="POST" action="{% url 'add_comment' post.id %}">
        {% csrf_token %}
        <textarea name="content" placeholder="Add your comment here..." required></textarea>
        <button type="submit">Submit</button>
    </form>
    {% endif %}
</div> {% endcomment %}

